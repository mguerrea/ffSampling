#include "ffsampling.h"

// these constants are taken from https://github.com/tprest/falcon.py/

/* The roots of phi_4 = x^2 + 1
The second root is the conjugates of the first one. */
complex double phi4_roots[] = {1.00000000000000 * I, -1.00000000000000 * I};

/* The roots of phi_8 = x^4 + 1
The second half of the roots are is the conjugates of the first half.
The root at index (2 * i + 1) is the negation of the root at index (2 * i). */
complex double phi8_roots[] = {0.707106781186548 + 0.707106781186547 * I,
                               -0.707106781186548 - 0.707106781186547 * I,
                               0.707106781186548 - 0.707106781186547 * I,
                               -0.707106781186548 + 0.707106781186547 * I};

/* The roots of phi_16 = x^8 + 1
The second half of the roots are is the conjugates of the first half.
The root at index (2 * i + 1) is the negation of the root at index (2 * i). */
complex double phi16_roots[] = {0.923879532511287 + 0.382683432365090 * I,
                                -0.923879532511287 - 0.382683432365090 * I,
                                0.382683432365090 - 0.923879532511287 * I,
                                -0.382683432365090 + 0.923879532511287 * I,
                                0.923879532511287 - 0.382683432365090 * I,
                                -0.923879532511287 + 0.382683432365090 * I,
                                0.382683432365090 + 0.923879532511287 * I,
                                -0.382683432365090 - 0.923879532511287 * I};

/* The roots of phi_32 = x^16 + 1
The second half of the roots are is the conjugates of the first half.
The root at index (2 * i + 1) is the negation of the root at index (2 * i). */
complex double phi32_roots[] = {0.980785280403230 + 0.195090322016128 * I,
                                -0.980785280403230 - 0.195090322016128 * I,
                                0.195090322016128 - 0.980785280403230 * I,
                                -0.195090322016128 + 0.980785280403230 * I,
                                0.831469612302545 - 0.555570233019602 * I,
                                -0.831469612302545 + 0.555570233019602 * I,
                                0.555570233019602 + 0.831469612302545 * I,
                                -0.555570233019602 - 0.831469612302545 * I,
                                0.980785280403230 - 0.195090322016128 * I,
                                -0.980785280403230 + 0.195090322016128 * I,
                                0.195090322016128 + 0.980785280403230 * I,
                                -0.195090322016128 - 0.980785280403230 * I,
                                0.831469612302545 + 0.555570233019602 * I,
                                -0.831469612302545 - 0.555570233019602 * I,
                                0.555570233019602 - 0.831469612302545 * I,
                                -0.555570233019602 + 0.831469612302545 * I};

/* The roots of phi_64 = x^32 + 1
The second half of the roots are is the conjugates of the first half.
The root at index (2 * i + 1) is the negation of the root at index (2 * i). */
complex double phi64_roots[] = {0.995184726672197 + 0.0980171403295606 * I,
                                -0.995184726672197 - 0.0980171403295606 * I,
                                0.0980171403295606 - 0.995184726672197 * I,
                                -0.0980171403295606 + 0.995184726672197 * I,
                                0.773010453362737 - 0.634393284163646 * I,
                                -0.773010453362737 + 0.634393284163646 * I,
                                0.634393284163645 + 0.773010453362737 * I,
                                -0.634393284163645 - 0.773010453362737 * I,
                                0.956940335732209 - 0.290284677254462 * I,
                                -0.956940335732209 + 0.290284677254462 * I,
                                0.290284677254462 + 0.956940335732209 * I,
                                -0.290284677254462 - 0.956940335732209 * I,
                                0.881921264348355 + 0.471396736825998 * I,
                                -0.881921264348355 - 0.471396736825998 * I,
                                0.471396736825998 - 0.881921264348355 * I,
                                -0.471396736825998 + 0.881921264348355 * I,
                                0.995184726672197 - 0.0980171403295606 * I,
                                -0.995184726672197 + 0.0980171403295606 * I,
                                0.0980171403295606 + 0.995184726672197 * I,
                                -0.0980171403295606 - 0.995184726672197 * I,
                                0.773010453362737 + 0.634393284163646 * I,
                                -0.773010453362737 - 0.634393284163646 * I,
                                0.634393284163645 - 0.773010453362737 * I,
                                -0.634393284163645 + 0.773010453362737 * I,
                                0.956940335732209 + 0.290284677254462 * I,
                                -0.956940335732209 - 0.290284677254462 * I,
                                0.290284677254462 - 0.956940335732209 * I,
                                -0.290284677254462 + 0.956940335732209 * I,
                                0.881921264348355 - 0.471396736825998 * I,
                                -0.881921264348355 + 0.471396736825998 * I,
                                0.471396736825998 + 0.881921264348355 * I,
                                -0.471396736825998 - 0.881921264348355 * I};

/* The roots of phi_128 = x^64 + 1
The second half of the roots are is the conjugates of the first half.
The root at index (2 * i + 1) is the negation of the root at index (2 * i). */
complex double phi128_roots[] = {0.998795456205172 + 0.0490676743274180 * I,
                               -0.998795456205172 - 0.0490676743274180 * I,
                               0.0490676743274180 - 0.998795456205172 * I,
                               -0.0490676743274180 + 0.998795456205172 * I,
                               0.740951125354959 - 0.671558954847018 * I,
                               -0.740951125354959 + 0.671558954847018 * I,
                               0.671558954847018 + 0.740951125354959 * I,
                               -0.671558954847018 - 0.740951125354959 * I,
                               0.941544065183021 - 0.336889853392220 * I,
                               -0.941544065183021 + 0.336889853392220 * I,
                               0.336889853392220 + 0.941544065183021 * I,
                               -0.336889853392220 - 0.941544065183021 * I,
                               0.903989293123443 + 0.427555093430282 * I,
                               -0.903989293123443 - 0.427555093430282 * I,
                               0.427555093430282 - 0.903989293123443 * I,
                               -0.427555093430282 + 0.903989293123443 * I,
                               0.989176509964781 - 0.146730474455362 * I,
                               -0.989176509964781 + 0.146730474455362 * I,
                               0.146730474455362 + 0.989176509964781 * I,
                               -0.146730474455362 - 0.989176509964781 * I,
                               0.803207531480645 + 0.595699304492433 * I,
                               -0.803207531480645 - 0.595699304492433 * I,
                               0.595699304492433 - 0.803207531480645 * I,
                               -0.595699304492433 + 0.803207531480645 * I,
                               0.970031253194544 + 0.242980179903264 * I,
                               -0.970031253194544 - 0.242980179903264 * I,
                               0.242980179903264 - 0.970031253194544 * I,
                               -0.242980179903264 + 0.970031253194544 * I,
                               0.857728610000272 - 0.514102744193222 * I,
                               -0.857728610000272 + 0.514102744193222 * I,
                               0.514102744193222 + 0.857728610000272 * I,
                               -0.514102744193222 - 0.857728610000272 * I,
                               0.998795456205172 - 0.0490676743274180 * I,
                               -0.998795456205172 + 0.0490676743274180 * I,
                               0.0490676743274180 + 0.998795456205172 * I,
                               -0.0490676743274180 - 0.998795456205172 * I,
                               0.740951125354959 + 0.671558954847018 * I,
                               -0.740951125354959 - 0.671558954847018 * I,
                               0.671558954847018 - 0.740951125354959 * I,
                               -0.671558954847018 + 0.740951125354959 * I,
                               0.941544065183021 + 0.336889853392220 * I,
                               -0.941544065183021 - 0.336889853392220 * I,
                               0.336889853392220 - 0.941544065183021 * I,
                               -0.336889853392220 + 0.941544065183021 * I,
                               0.903989293123443 - 0.427555093430282 * I,
                               -0.903989293123443 + 0.427555093430282 * I,
                               0.427555093430282 + 0.903989293123443 * I,
                               -0.427555093430282 - 0.903989293123443 * I,
                               0.989176509964781 + 0.146730474455362 * I,
                               -0.989176509964781 - 0.146730474455362 * I,
                               0.146730474455362 - 0.989176509964781 * I,
                               -0.146730474455362 + 0.989176509964781 * I,
                               0.803207531480645 - 0.595699304492433 * I,
                               -0.803207531480645 + 0.595699304492433 * I,
                               0.595699304492433 + 0.803207531480645 * I,
                               -0.595699304492433 - 0.803207531480645 * I,
                               0.970031253194544 - 0.242980179903264 * I,
                               -0.970031253194544 + 0.242980179903264 * I,
                               0.242980179903264 + 0.970031253194544 * I,
                               -0.242980179903264 - 0.970031253194544 * I,
                               0.857728610000272 + 0.514102744193222 * I,
                               -0.857728610000272 - 0.514102744193222 * I,
                               0.514102744193222 - 0.857728610000272 * I,
                               -0.514102744193222 + 0.857728610000272 * I};

/* The roots of phi_256 = x^128 + 1
The second half of the roots are is the conjugates of the first half.
The root at index (2 * i + 1) is the negation of the root at index (2 * i). */
complex double phi256_roots[] = {0.999698818696204 + 0.0245412285229123*I,
                -0.999698818696204 - 0.0245412285229123*I,
                0.0245412285229123 - 0.999698818696204*I,
                -0.0245412285229123 + 0.999698818696204*I,
                0.724247082951467 - 0.689540544737067*I,
                -0.724247082951467 + 0.689540544737067*I,
                0.689540544737067 + 0.724247082951467*I,
                -0.689540544737067 - 0.724247082951467*I,
                0.932992798834739 - 0.359895036534988*I,
                -0.932992798834739 + 0.359895036534988*I,
                0.359895036534988 + 0.932992798834739*I,
                -0.359895036534988 - 0.932992798834739*I,
                0.914209755703531 + 0.405241314004990*I,
                -0.914209755703531 - 0.405241314004990*I,
                0.405241314004990 - 0.914209755703531*I,
                -0.405241314004990 + 0.914209755703531*I,
                0.985277642388941 - 0.170961888760301*I,
                -0.985277642388941 + 0.170961888760301*I,
                0.170961888760301 + 0.985277642388941*I,
                -0.170961888760301 - 0.985277642388941*I,
                0.817584813151584 + 0.575808191417845*I,
                -0.817584813151584 - 0.575808191417845*I,
                0.575808191417845 - 0.817584813151584*I,
                -0.575808191417845 + 0.817584813151584*I,
                0.975702130038529 + 0.219101240156870*I,
                -0.975702130038529 - 0.219101240156870*I,
                0.219101240156870 - 0.975702130038529*I,
                -0.219101240156870 + 0.975702130038529*I,
                0.844853565249707 - 0.534997619887097*I,
                -0.844853565249707 + 0.534997619887097*I,
                0.534997619887097 + 0.844853565249707*I,
                -0.534997619887097 - 0.844853565249707*I,
                0.997290456678690 - 0.0735645635996674*I,
                -0.997290456678690 + 0.0735645635996674*I,
                0.0735645635996674 + 0.997290456678690*I,
                -0.0735645635996674 - 0.997290456678690*I,
                0.757208846506485 + 0.653172842953777*I,
                -0.757208846506485 - 0.653172842953777*I,
                0.653172842953777 - 0.757208846506485*I,
                -0.653172842953777 + 0.757208846506485*I,
                0.949528180593037 + 0.313681740398892*I,
                -0.949528180593037 - 0.313681740398892*I,
                0.313681740398892 - 0.949528180593037*I,
                -0.313681740398892 + 0.949528180593037*I,
                0.893224301195515 - 0.449611329654607*I,
                -0.893224301195515 + 0.449611329654607*I,
                0.449611329654607 + 0.893224301195515*I,
                -0.449611329654607 - 0.893224301195515*I,
                0.992479534598710 + 0.122410675199216*I,
                -0.992479534598710 - 0.122410675199216*I,
                0.122410675199216 - 0.992479534598710*I,
                -0.122410675199216 + 0.992479534598710*I,
                0.788346427626606 - 0.615231590580627*I,
                -0.788346427626606 + 0.615231590580627*I,
                0.615231590580627 + 0.788346427626606*I,
                -0.615231590580627 - 0.788346427626606*I,
                0.963776065795440 - 0.266712757474898*I,
                -0.963776065795440 + 0.266712757474898*I,
                0.266712757474898 + 0.963776065795440*I,
                -0.266712757474898 - 0.963776065795440*I,
                0.870086991108711 + 0.492898192229784*I,
                -0.870086991108711 - 0.492898192229784*I,
                0.492898192229784 - 0.870086991108711*I,
                -0.492898192229784 + 0.870086991108711*I,
                0.999698818696204 - 0.0245412285229123*I,
                -0.999698818696204 + 0.0245412285229123*I,
                0.0245412285229123 + 0.999698818696204*I,
                -0.0245412285229123 - 0.999698818696204*I,
                0.724247082951467 + 0.689540544737067*I,
                -0.724247082951467 - 0.689540544737067*I,
                0.689540544737067 - 0.724247082951467*I,
                -0.689540544737067 + 0.724247082951467*I,
                0.932992798834739 + 0.359895036534988*I,
                -0.932992798834739 - 0.359895036534988*I,
                0.359895036534988 - 0.932992798834739*I,
                -0.359895036534988 + 0.932992798834739*I,
                0.914209755703531 - 0.405241314004990*I,
                -0.914209755703531 + 0.405241314004990*I,
                0.405241314004990 + 0.914209755703531*I,
                -0.405241314004990 - 0.914209755703531*I,
                0.985277642388941 + 0.170961888760301*I,
                -0.985277642388941 - 0.170961888760301*I,
                0.170961888760301 - 0.985277642388941*I,
                -0.170961888760301 + 0.985277642388941*I,
                0.817584813151584 - 0.575808191417845*I,
                -0.817584813151584 + 0.575808191417845*I,
                0.575808191417845 + 0.817584813151584*I,
                -0.575808191417845 - 0.817584813151584*I,
                0.975702130038529 - 0.219101240156870*I,
                -0.975702130038529 + 0.219101240156870*I,
                0.219101240156870 + 0.975702130038529*I,
                -0.219101240156870 - 0.975702130038529*I,
                0.844853565249707 + 0.534997619887097*I,
                -0.844853565249707 - 0.534997619887097*I,
                0.534997619887097 - 0.844853565249707*I,
                -0.534997619887097 + 0.844853565249707*I,
                0.997290456678690 + 0.0735645635996674*I,
                -0.997290456678690 - 0.0735645635996674*I,
                0.0735645635996674 - 0.997290456678690*I,
                -0.0735645635996674 + 0.997290456678690*I,
                0.757208846506485 - 0.653172842953777*I,
                -0.757208846506485 + 0.653172842953777*I,
                0.653172842953777 + 0.757208846506485*I,
                -0.653172842953777 - 0.757208846506485*I,
                0.949528180593037 - 0.313681740398892*I,
                -0.949528180593037 + 0.313681740398892*I,
                0.313681740398892 + 0.949528180593037*I,
                -0.313681740398892 - 0.949528180593037*I,
                0.893224301195515 + 0.449611329654607*I,
                -0.893224301195515 - 0.449611329654607*I,
                0.449611329654607 - 0.893224301195515*I,
                -0.449611329654607 + 0.893224301195515*I,
                0.992479534598710 - 0.122410675199216*I,
                -0.992479534598710 + 0.122410675199216*I,
                0.122410675199216 + 0.992479534598710*I,
                -0.122410675199216 - 0.992479534598710*I,
                0.788346427626606 + 0.615231590580627*I,
                -0.788346427626606 - 0.615231590580627*I,
                0.615231590580627 - 0.788346427626606*I,
                -0.615231590580627 + 0.788346427626606*I,
                0.963776065795440 + 0.266712757474898*I,
                -0.963776065795440 - 0.266712757474898*I,
                0.266712757474898 - 0.963776065795440*I,
                -0.266712757474898 + 0.963776065795440*I,
                0.870086991108711 - 0.492898192229784*I,
                -0.870086991108711 + 0.492898192229784*I,
                0.492898192229784 + 0.870086991108711*I,
                -0.492898192229784 - 0.870086991108711*I};

complex double *roots[] = {phi4_roots, phi8_roots, phi16_roots, phi32_roots,
                           phi64_roots, phi128_roots, phi256_roots};

//Roots of phi_4 = x^2 + 1.
int phi4_roots_Zq[] = {1479, 10810};
//Roots of phi_8 = x^4 + 1
int phi8_roots_Zq[] = {4043, 8246, 5146, 7143};
//Roots of phi_16 = x^8 + 1
int phi16_roots_Zq[] = {5736, 6553, 4134, 8155, 722, 11567, 1305, 10984};
//Roots of phi_32 = x^16 + 1
int phi32_roots_Zq[] = {1646, 10643, 1212, 11077, 5860, 6429, 3195, 9094, 2545, 9744, 3621, 8668, 3504, 8785, 3542, 8747};
//Roots of phi_64 = x^32 + 1
int phi64_roots_Zq[] = {4591, 7698, 5728, 6561, 5023, 7266, 5828, 6461, 4978, 7311, 1351, 10938, 3328, 8961, 5777, 6512, 2975, 9314, 563, 11726, 3006, 9283, 2744, 9545, 949, 11340, 2625, 9664, 4821, 7468, 2639, 9650};
//Roots of phi_128 = x^64 + 1
int phi128_roots_Zq[] = {1000, 11289, 4320, 7969, 3091, 9198, 81, 12208, 2963, 9326, 4896, 7393, 3051, 9238, 2366, 9923, 1853, 10436, 140, 12149, 4611, 7678, 726, 11563, 4255, 8034, 1177, 11112, 2768, 9521, 1635, 10654, 3712, 8577, 3135, 9154, 2747, 9542, 4846, 7443, 3553, 8736, 4805, 7484, 2294, 9995, 1062, 11227, 1326, 10963, 5086, 7203, 3014, 9275, 3201, 9088, 1170, 11119, 2319, 9970, 955, 11334, 790, 11499};
//Roots of phi_256 = x^128 + 1
int phi256_roots_Zq[] = {544, 11745, 5791, 6498, 339, 11950, 2468, 9821, 2842, 9447, 480, 11809, 9, 12280, 1022, 11267, 4278, 8011, 1673, 10616, 4989, 7300, 5331, 6958, 3584, 8705, 4177, 8112, 1381, 10908, 2525, 9764, 2396, 9893, 4452, 7837, 3296, 8993, 3949, 8340, 130, 12159, 4354, 7935, 5374, 6915, 2837, 9452, 5767, 6522, 827, 11462, 3748, 8541, 953, 11336, 5067, 7222, 2197, 10092, 118, 12171, 2476, 9813, 2548, 9741, 4231, 8058, 355, 11934, 3382, 8907, 3707, 8582, 1759, 10530, 3694, 8595, 5179, 7110, 5542, 6747, 145, 12144, 3637, 8652, 3459, 8830, 5911, 6378, 4890, 7399, 3932, 8357, 2731, 9558, 2089, 10200, 5092, 7197, 2881, 9408, 3284, 9005, 729, 11560, 3241, 9048, 3289, 9000, 2013, 10276, 5755, 6534, 4632, 7657, 1260, 11029, 4388, 7901, 334, 11955, 2426, 9863, 1696, 10593, 1428, 10861};

int *roots_Zq[] = {phi4_roots_Zq, phi8_roots_Zq, phi16_roots_Zq,
                   phi32_roots_Zq, phi64_roots_Zq, phi128_roots_Zq,
                   phi256_roots_Zq};
